import{_ as k,o,c,a as e,t as u,e as _,k as I,j as O,b as x,F as m,p as v,u as T,s as f}from"./index-jtXfzA2B.js";import{A as B,f as S}from"./utils-QIWl4SV_.js";import{H as j}from"./HeaderClient-B8Ytj1mM.js";import{F as z}from"./Footer-DGqKp_qG.js";import{_ as E,a as F,b as L,c as V}from"./principales-Cih8RTq0.js";import{a as J}from"./restaurante-D9iIAsPc.js";const R={props:{plato:{type:Object,required:!0}},methods:{addDish(){this.$emit("add",this.plato)},getDishImage(w){var i;const p=Object.assign({"/src/assets/images/dishes/bebidas.png":E,"/src/assets/images/dishes/entrantes.png":F,"/src/assets/images/dishes/postres.png":L,"/src/assets/images/dishes/principales.png":V,"/src/assets/images/dishes/restaurante.png":J}),d=`/src/assets/images/dishes/${w.toLowerCase()}.png`;return((i=p[d])==null?void 0:i.default)||"@/assets/images/dishes/default.png"}}},H={id:"plato",class:"info-plato"},q={class:"container-info"},W={class:"txt-1vw"},G={class:"txt-1vw"},K={class:"txt-1vw"},Q={class:"txt-1vw"},U=["src","alt"];function X(w,p,a,d,i,n){return o(),c("div",H,[e("div",q,[e("div",null,[e("p",W,u(a.plato.nombre||"N/A"),1),e("p",G,u(a.plato.descripcion||"N/A"),1),e("p",K,u(a.plato.ingredientes||"N/A"),1),e("p",Q,u(a.plato.precio?`${a.plato.precio}€`:"N/A"),1)]),e("img",{src:n.getDishImage(a.plato.tipo_plato),alt:`Imagen de ${a.plato.nombre||"plato"}`},null,8,U)]),e("button",{class:"btn-anadir txt-1vw",onClick:p[0]||(p[0]=(...y)=>n.addDish&&n.addDish(...y))},"Añadir")])}const b=k(R,[["render",X],["__scopeId","data-v-092c8339"]]),Y={class:"titulo-menu txt-3vw"},Z={class:"container-general"},ee={class:"container-menu"},se={class:"container-dish"},te={class:"lista-platos"},ae={class:"container-dish"},oe={class:"lista-platos"},ne={class:"container-dish"},ie={class:"lista-platos"},le={class:"container-dish"},re={class:"lista-platos"},de={class:"container-comanda"},ce={class:"txt-1-5vw"},ue=["onClick"],pe={class:"txt-1-5vw"},_e={__name:"ClientMenuView",setup(w){const p=_([]),a=_(""),d=_([]),i=_(""),n=_(!1),{isAuthenticated:y,user:C,isLoading:me}=T(),A=C.value.name,D=()=>{const t=sessionStorage.getItem("platos"),s=sessionStorage.getItem("nombre_restaurante");t&&(p.value=JSON.parse(t)),s&&(a.value=s)};I(()=>{D()});const N=O(()=>d.value.reduce((t,s)=>t+parseFloat(s.precio||0),0)),h=t=>p.value.filter(s=>s.tipo_plato===t),g=t=>{d.value.push(t)},P=()=>{d.value.length===0?(i.value="Debe agregar al menos un producto a la comanda para realizar el pedido 😕",n.value=!0):$()},M=()=>{n.value=!1,window.location.reload()};async function $(){try{const t=await S("https://api-jummy.onrender.com/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:A,nombres_platos:d.value.map(s=>s.nombre),nombre_comercial:a.value})},1e4);t.status===201?(i.value="La comanda ha sido enviada correctamente, gracias por confiar en Jummy 😎",n.value=!0):t.status===500?(i.value="No se ha podido registrar la comanda enviada",n.value=!0):(i.value=`Error inesperado en el servidor
${t.statusText} 🛠️`,n.value=!0)}catch(t){i.value=t.message.includes("tiempo de espera")?"La solicitud ha excedido el tiempo de espera. Por favor, intentelo de nuevo mas tarde":"Error inesperado durante la solicitud",n.value=!0}}return(t,s)=>(o(),c("main",null,[x(j,{"show-return":!0}),e("div",null,[e("h1",Y,u(a.value),1)]),e("div",Z,[e("div",ee,[e("div",se,[s[0]||(s[0]=e("h2",{class:"txt-1-5vw"},"Entrantes",-1)),e("div",te,[(o(!0),c(m,null,v(h("Entrantes"),(l,r)=>(o(),f(b,{key:r,plato:l,onAdd:g},null,8,["plato"]))),128))])]),e("div",ae,[s[1]||(s[1]=e("h2",{class:"txt-1-5vw"},"Principales",-1)),e("div",oe,[(o(!0),c(m,null,v(h("Principales"),(l,r)=>(o(),f(b,{key:r,plato:l,onAdd:g},null,8,["plato"]))),128))])]),e("div",ne,[s[2]||(s[2]=e("h2",{class:"txt-1-5vw"},"Postres",-1)),e("div",ie,[(o(!0),c(m,null,v(h("Postres"),(l,r)=>(o(),f(b,{key:r,plato:l,onAdd:g},null,8,["plato"]))),128))])]),e("div",le,[s[3]||(s[3]=e("h2",{class:"txt-1-5vw"},"Bebidas",-1)),e("div",re,[(o(!0),c(m,null,v(h("Bebidas"),(l,r)=>(o(),f(b,{key:r,plato:l,onAdd:g},null,8,["plato"]))),128))])])]),e("div",de,[s[4]||(s[4]=e("h2",{class:"txt-2vw"},"Comanda",-1)),(o(!0),c(m,null,v(d.value,(l,r)=>(o(),c("div",{key:r,class:"container-plato"},[e("p",ce,u(l.nombre)+" "+u(l.precio)+"€",1),e("span",{class:"txt-1-5vw",onClick:ve=>d.value.splice(r,1)},"🗑️",8,ue)]))),128)),e("p",pe,"Total: "+u(N.value)+"€",1),e("button",{class:"btn-realizar-pedido txt-1vw",onClick:P},"Realizar pedido")])]),x(z),x(B,{message:i.value,visible:n.value,onClose:M},null,8,["message","visible"])]))}},ye=k(_e,[["__scopeId","data-v-315dfd42"]]);export{ye as default};
