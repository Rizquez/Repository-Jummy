import{_ as I,e as g,r as S,o as r,c as f,a as e,x as T,f as c,v as b,b as P,F as k,k as j,w as O,p as C,m as F,d as J,s as M,u as L}from"./index-D73NRxAB.js";import{A as h,v as N,f as E}from"./utils-CQI9Zwo-.js";import{F as _}from"./Footer-ByYSq2Vq.js";import{_ as $}from"./plato-lujo-C4X_G4ez.js";const G={props:{plato:{type:Object,required:!0}},components:{AlertModal:h},setup(){const d=g(""),s=g(!1);return{modalMessage:d,isModalVisible:s,handleModalClose:()=>{s.value=!1}}},methods:{handleInput(d){N(d)},async udpateDishDrink(){const d={email:sessionStorage.getItem("email"),nombre:this.plato.nombre,descripcion:this.plato.descripcion,ingredientes:this.plato.ingredientes,precio:this.plato.precio};try{const s=await E("https://api-jummy.onrender.com/update-dish",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)},1e4);s.ok?this.modalMessage="El plato se actualizo correctamente":this.modalMessage=`Error al guardar el plato: ${s.statusText}`}catch(s){this.modalMessage=`Error inesperado: ${s.message}`}finally{this.isModalVisible=!0}}}},R={class:"form-center"};function z(d,s,i,p,x,n){const V=S("AlertModal");return r(),f(k,null,[e("div",R,[e("form",{onSubmit:s[6]||(s[6]=T((...l)=>d.savePlato&&d.savePlato(...l),["prevent"]))},[c(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=l=>i.plato.nombre=l),required:"",readonly:""},null,512),[[b,i.plato.nombre]]),c(e("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=l=>i.plato.descripcion=l),required:""},null,512),[[b,i.plato.descripcion]]),c(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=l=>i.plato.ingredientes=l),required:""},null,512),[[b,i.plato.ingredientes]]),c(e("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=l=>i.plato.precio=l),onInput:s[4]||(s[4]=(...l)=>n.handleInput&&n.handleInput(...l)),required:""},null,544),[[b,i.plato.precio]]),e("button",{onClick:s[5]||(s[5]=(...l)=>n.udpateDishDrink&&n.udpateDishDrink(...l)),class:"txt-0-8vw",type:"submit"},"Guardar cambios")],32),s[7]||(s[7]=e("img",{src:$,alt:"Imagen plato"},null,-1))]),P(V,{message:p.modalMessage,visible:p.isModalVisible,onClose:p.handleModalClose},null,8,["message","visible","onClose"])],64)}const D=I(G,[["render",z],["__scopeId","data-v-681fc9ff"]]),W={class:"container-btn-nav"},H={class:"container-volver-salir"},K={class:"contaniner-dish"},Q={class:"contaniner-anadir"},X={class:"lista-platos"},Y={class:"contaniner-dish"},Z={class:"contaniner-anadir"},ee={class:"lista-platos"},te={class:"contaniner-dish"},se={class:"contaniner-anadir"},oe={class:"lista-platos"},ne={class:"contaniner-dish"},ie={class:"contaniner-anadir"},le={class:"lista-platos"},ae={class:"boton-anadir-container"},re={key:0,class:"modal"},de={__name:"CompanyEditMenuView",setup(d){const s=g([]),i=g(""),p=g(!1),x=g(!1),n=g({nombre:"",descripcion:"",ingredientes:"",precio:0,tipo_plato:"",email:""}),V=()=>{const a=sessionStorage.getItem("platos"),t=sessionStorage.getItem("email");a&&(s.value=JSON.parse(a)),t&&(n.value.email=t)};j(()=>{V()});const l=a=>{N(a)},w=a=>s.value.filter(t=>t.tipo_plato===a),m=a=>{x.value=!0,n.value.tipo_plato=a},y=()=>{x.value=!1},{logout:B}=L(),q=()=>{sessionStorage.clear(),B({returnTo:window.location.origin})},A=()=>{p.value=!1},U=async a=>{a.preventDefault();const t={email:n.value.email,nombre:n.value.nombre,descripcion:n.value.descripcion,ingredientes:n.value.ingredientes,precio:n.value.precio,tipo_plato:n.value.tipo_plato};try{const v=await E("https://api-jummy.onrender.com/create-dish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)},1e4);if(v.status===201){y(),i.value="El nuevo plato/bebida se ha registrado correctamente";const u=await(await E("https://api-jummy.onrender.com/find-dishes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n.value.email})},1e4)).json();s.value=u.data}else v.status===500?(y(),i.value=`Los datos no se han podido registrar
(${v.statusText}) 🛠️`):(y(),i.value=`Error inesperado en el servidor
${v.statusText} 🛠️`);p.value=!0}catch(v){y(),i.value=v.message.includes("tiempo de espera")?"La solicitud ha excedido el tiempo de espera. Por favor, intentelo de nuevo mas tarde":"Error inesperado durante la solicitud",p.value=!0}};return(a,t)=>{const v=S("router-link");return r(),f("main",null,[t[23]||(t[23]=e("h1",{class:"txt-3vw"},"Carta",-1)),e("div",W,[e("div",null,[e("ul",null,[e("li",null,[e("button",{class:"txt-1-5vw",onClick:t[0]||(t[0]=o=>m("Entrantes"))},"Entrantes")]),e("li",null,[e("button",{class:"txt-1-5vw",onClick:t[1]||(t[1]=o=>m("Principales"))},"Principales")]),e("li",null,[e("button",{class:"txt-1-5vw",onClick:t[2]||(t[2]=o=>m("Postres"))},"Postres")]),e("li",null,[e("button",{class:"txt-1-5vw",onClick:t[3]||(t[3]=o=>m("Bebidas"))},"Bebidas")])])]),e("div",H,[e("p",{class:"boton-salir txt-1-5vw",onClick:q},"Salir"),P(v,{to:{name:"company-menu"},class:"btn-volver txt-1-5vw"},{default:O(()=>t[12]||(t[12]=[J("Volver")])),_:1})])]),e("div",K,[t[13]||(t[13]=e("p",{class:"txt-1-5vw"},"Entrantes",-1)),e("div",Q,[e("button",{class:"anadir",onClick:t[4]||(t[4]=o=>m("Entrantes"))},"Añadir entrante")]),e("div",X,[(r(!0),f(k,null,C(w("Entrantes"),(o,u)=>(r(),M(D,{key:u,plato:o},null,8,["plato"]))),128))])]),e("div",Y,[t[14]||(t[14]=e("p",{class:"txt-1-5vw"},"Principales",-1)),e("div",Z,[e("button",{class:"anadir",onClick:t[5]||(t[5]=o=>m("Principales"))},"Añadir principal")]),e("div",ee,[(r(!0),f(k,null,C(w("Principales"),(o,u)=>(r(),M(D,{key:u,plato:o},null,8,["plato"]))),128))])]),e("div",te,[t[15]||(t[15]=e("p",{class:"txt-1-5vw"},"Bebidas",-1)),e("div",se,[e("button",{class:"anadir",onClick:t[6]||(t[6]=o=>m("Bebidas"))},"Añadir bebida")]),e("div",oe,[(r(!0),f(k,null,C(w("Bebidas"),(o,u)=>(r(),M(D,{key:u,plato:o},null,8,["plato"]))),128))])]),e("div",ne,[t[16]||(t[16]=e("p",{class:"txt-1-5vw"},"Postres",-1)),e("div",ie,[e("button",{class:"anadir",onClick:t[7]||(t[7]=o=>m("Postres"))},"Añadir postre")]),e("div",le,[(r(!0),f(k,null,C(w("Postres"),(o,u)=>(r(),M(D,{key:u,plato:o},null,8,["plato"]))),128))])]),P(_),P(h,{message:i.value,visible:p.value,onClose:A},null,8,["message","visible"]),e("div",ae,[x.value?(r(),f("div",re,[t[22]||(t[22]=e("h2",null,"Añadir Plato/Bebida",-1)),e("form",{onSubmit:T(U,["prevent"])},[e("div",null,[t[17]||(t[17]=e("label",{for:"nombre-plato"},"Nombre:",-1)),c(e("input",{type:"text",id:"nombre-plato","onUpdate:modelValue":t[8]||(t[8]=o=>n.value.nombre=o),required:""},null,512),[[b,n.value.nombre]])]),e("div",null,[t[18]||(t[18]=e("label",{for:"descripcion"},"Descripción:",-1)),c(e("textarea",{id:"descripcion","onUpdate:modelValue":t[9]||(t[9]=o=>n.value.descripcion=o),required:""},null,512),[[b,n.value.descripcion]])]),e("div",null,[t[19]||(t[19]=e("label",{for:"ingredientes"},"Ingredientes:",-1)),c(e("textarea",{id:"ingredientes","onUpdate:modelValue":t[10]||(t[10]=o=>n.value.ingredientes=o),required:""},null,512),[[b,n.value.ingredientes]])]),e("div",null,[t[20]||(t[20]=e("label",{for:"precio"},"Precio:",-1)),c(e("input",{type:"text",id:"precio","onUpdate:modelValue":t[11]||(t[11]=o=>n.value.precio=o),onInput:l,required:""},null,544),[[b,n.value.precio]])]),e("div",{class:"modal-buttons"},[t[21]||(t[21]=e("button",{type:"submit"},"Guardar",-1)),e("button",{type:"button",onClick:y},"Cancelar")])],32)])):F("",!0)])])}}},ce=I(de,[["__scopeId","data-v-ffbfc34e"]]);export{ce as default};
