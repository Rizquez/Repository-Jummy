import{_ as V,e as y,r as E,o as d,c as f,a as e,x as I,f as c,v as b,b as P,F as k,k as A,w as U,p as w,m as O,d as F,s as C,u as L}from"./index-jtXfzA2B.js";import{A as T,v as S,f as M}from"./utils-QIWl4SV_.js";import{F as J}from"./Footer-DGqKp_qG.js";import{_ as z,a as $,b as G,c as R}from"./principales-Cih8RTq0.js";import{a as W}from"./restaurante-D9iIAsPc.js";const H={props:{plato:{type:Object,required:!0}},components:{AlertModal:T},setup(){const l=y(""),s=y(!1);return{modalMessage:l,isModalVisible:s,handleModalClose:()=>{s.value=!1}}},methods:{handleInput(l){S(l)},getDishImage(l){var g;const s=Object.assign({"/src/assets/images/dishes/bebidas.png":z,"/src/assets/images/dishes/entrantes.png":$,"/src/assets/images/dishes/postres.png":G,"/src/assets/images/dishes/principales.png":R,"/src/assets/images/dishes/restaurante.png":W}),u=`/src/assets/images/dishes/${l.toLowerCase()}.png`;return((g=s[u])==null?void 0:g.default)||"@/assets/images/dishes/default.png"},async udpateDishDrink(){const l={email:sessionStorage.getItem("email"),nombre:this.plato.nombre,descripcion:this.plato.descripcion,ingredientes:this.plato.ingredientes,precio:this.plato.precio};try{const s=await M("https://api-jummy.onrender.com/update-dish",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)},1e4);s.ok?this.modalMessage="El plato se actualizo correctamente":this.modalMessage=`Error al guardar el plato: ${s.statusText}`}catch(s){this.modalMessage=`Error inesperado: ${s.message}`}finally{this.isModalVisible=!0}}}},K={class:"form-center"},Q=["src","alt"];function X(l,s,a,u,g,n){const D=E("AlertModal");return d(),f(k,null,[e("div",K,[e("form",{onSubmit:s[6]||(s[6]=I((...i)=>l.savePlato&&l.savePlato(...i),["prevent"]))},[c(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=i=>a.plato.nombre=i),required:"",readonly:""},null,512),[[b,a.plato.nombre]]),c(e("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=i=>a.plato.descripcion=i),required:""},null,512),[[b,a.plato.descripcion]]),c(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=i=>a.plato.ingredientes=i),required:""},null,512),[[b,a.plato.ingredientes]]),c(e("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=i=>a.plato.precio=i),onInput:s[4]||(s[4]=(...i)=>n.handleInput&&n.handleInput(...i)),required:""},null,544),[[b,a.plato.precio]]),e("button",{onClick:s[5]||(s[5]=(...i)=>n.udpateDishDrink&&n.udpateDishDrink(...i)),class:"txt-0-8vw",type:"submit"},"Guardar cambios")],32),e("img",{src:n.getDishImage(a.plato.tipo_plato),alt:`Imagen de ${a.plato.nombre||"plato"}`},null,8,Q)]),P(D,{message:u.modalMessage,visible:u.isModalVisible,onClose:u.handleModalClose},null,8,["message","visible","onClose"])],64)}const h=V(H,[["render",X],["__scopeId","data-v-91d38a37"]]),Y={class:"container-btn-nav"},Z={class:"container-volver-salir"},ee={class:"contaniner-dish"},te={class:"contaniner-anadir"},se={class:"lista-platos"},oe={class:"contaniner-dish"},ne={class:"contaniner-anadir"},ae={class:"lista-platos"},ie={class:"contaniner-dish"},le={class:"contaniner-anadir"},re={class:"lista-platos"},de={class:"contaniner-dish"},ue={class:"contaniner-anadir"},pe={class:"lista-platos"},me={class:"boton-anadir-container"},ve={key:0,class:"modal"},ce={__name:"CompanyEditMenuView",setup(l){const s=y([]),a=y(""),u=y(!1),g=y(!1),n=y({nombre:"",descripcion:"",ingredientes:"",precio:0,tipo_plato:"",email:""}),D=()=>{const r=sessionStorage.getItem("platos"),t=sessionStorage.getItem("email");r&&(s.value=JSON.parse(r)),t&&(n.value.email=t)};A(()=>{D()});const i=r=>{S(r)},x=r=>s.value.filter(t=>t.tipo_plato===r),m=r=>{g.value=!0,n.value.tipo_plato=r},_=()=>{g.value=!1},{logout:N}=L(),B=()=>{sessionStorage.clear(),N({returnTo:window.location.origin})},j=()=>{u.value=!1},q=async r=>{r.preventDefault();const t={email:n.value.email,nombre:n.value.nombre,descripcion:n.value.descripcion,ingredientes:n.value.ingredientes,precio:n.value.precio,tipo_plato:n.value.tipo_plato};try{const v=await M("https://api-jummy.onrender.com/create-dish",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)},1e4);if(v.status===201){_(),a.value="El nuevo plato/bebida se ha registrado correctamente";const p=await(await M("https://api-jummy.onrender.com/find-dishes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n.value.email})},1e4)).json();s.value=p.data}else v.status===500?(_(),a.value=`Los datos no se han podido registrar
(${v.statusText}) 🛠️`):(_(),a.value=`Error inesperado en el servidor
${v.statusText} 🛠️`);u.value=!0}catch(v){_(),a.value=v.message.includes("tiempo de espera")?"La solicitud ha excedido el tiempo de espera. Por favor, intentelo de nuevo mas tarde":"Error inesperado durante la solicitud",u.value=!0}};return(r,t)=>{const v=E("router-link");return d(),f("main",null,[t[23]||(t[23]=e("h1",{class:"txt-3vw"},"Carta",-1)),e("div",Y,[e("div",null,[e("ul",null,[e("li",null,[e("button",{class:"txt-1-5vw",onClick:t[0]||(t[0]=o=>m("Entrantes"))},"Entrantes")]),e("li",null,[e("button",{class:"txt-1-5vw",onClick:t[1]||(t[1]=o=>m("Principales"))},"Principales")]),e("li",null,[e("button",{class:"txt-1-5vw",onClick:t[2]||(t[2]=o=>m("Postres"))},"Postres")]),e("li",null,[e("button",{class:"txt-1-5vw",onClick:t[3]||(t[3]=o=>m("Bebidas"))},"Bebidas")])])]),e("div",Z,[e("p",{class:"boton-salir txt-1-5vw",onClick:B},"Salir"),P(v,{to:{name:"company-menu"},class:"btn-volver txt-1-5vw"},{default:U(()=>t[12]||(t[12]=[F("Volver")])),_:1})])]),e("div",ee,[t[13]||(t[13]=e("p",{class:"txt-1-5vw"},"Entrantes",-1)),e("div",te,[e("button",{class:"anadir",onClick:t[4]||(t[4]=o=>m("Entrantes"))},"Añadir entrante")]),e("div",se,[(d(!0),f(k,null,w(x("Entrantes"),(o,p)=>(d(),C(h,{key:p,plato:o},null,8,["plato"]))),128))])]),e("div",oe,[t[14]||(t[14]=e("p",{class:"txt-1-5vw"},"Principales",-1)),e("div",ne,[e("button",{class:"anadir",onClick:t[5]||(t[5]=o=>m("Principales"))},"Añadir principal")]),e("div",ae,[(d(!0),f(k,null,w(x("Principales"),(o,p)=>(d(),C(h,{key:p,plato:o},null,8,["plato"]))),128))])]),e("div",ie,[t[15]||(t[15]=e("p",{class:"txt-1-5vw"},"Bebidas",-1)),e("div",le,[e("button",{class:"anadir",onClick:t[6]||(t[6]=o=>m("Bebidas"))},"Añadir bebida")]),e("div",re,[(d(!0),f(k,null,w(x("Bebidas"),(o,p)=>(d(),C(h,{key:p,plato:o},null,8,["plato"]))),128))])]),e("div",de,[t[16]||(t[16]=e("p",{class:"txt-1-5vw"},"Postres",-1)),e("div",ue,[e("button",{class:"anadir",onClick:t[7]||(t[7]=o=>m("Postres"))},"Añadir postre")]),e("div",pe,[(d(!0),f(k,null,w(x("Postres"),(o,p)=>(d(),C(h,{key:p,plato:o},null,8,["plato"]))),128))])]),P(J),P(T,{message:a.value,visible:u.value,onClose:j},null,8,["message","visible"]),e("div",me,[g.value?(d(),f("div",ve,[t[22]||(t[22]=e("h2",null,"Añadir Plato/Bebida",-1)),e("form",{onSubmit:I(q,["prevent"])},[e("div",null,[t[17]||(t[17]=e("label",{for:"nombre-plato"},"Nombre:",-1)),c(e("input",{type:"text",id:"nombre-plato","onUpdate:modelValue":t[8]||(t[8]=o=>n.value.nombre=o),required:""},null,512),[[b,n.value.nombre]])]),e("div",null,[t[18]||(t[18]=e("label",{for:"descripcion"},"Descripción:",-1)),c(e("textarea",{id:"descripcion","onUpdate:modelValue":t[9]||(t[9]=o=>n.value.descripcion=o),required:""},null,512),[[b,n.value.descripcion]])]),e("div",null,[t[19]||(t[19]=e("label",{for:"ingredientes"},"Ingredientes:",-1)),c(e("textarea",{id:"ingredientes","onUpdate:modelValue":t[10]||(t[10]=o=>n.value.ingredientes=o),required:""},null,512),[[b,n.value.ingredientes]])]),e("div",null,[t[20]||(t[20]=e("label",{for:"precio"},"Precio:",-1)),c(e("input",{type:"text",id:"precio","onUpdate:modelValue":t[11]||(t[11]=o=>n.value.precio=o),onInput:i,required:""},null,544),[[b,n.value.precio]])]),e("div",{class:"modal-buttons"},[t[21]||(t[21]=e("button",{type:"submit"},"Guardar",-1)),e("button",{type:"button",onClick:_},"Cancelar")])],32)])):O("",!0)])])}}},ke=V(ce,[["__scopeId","data-v-ffbfc34e"]]);export{ke as default};
