import{_ as y,o as a,c as r,a as e,t as d,e as v,k as B,j as O,b as w,F as m,p as _,u as S,s as g}from"./index-D73NRxAB.js";import{A as E,f as F}from"./utils-CQI9Zwo-.js";import{H as I}from"./HeaderClient-CjD9r84i.js";import{F as T}from"./Footer-ByYSq2Vq.js";import{_ as V}from"./plato-lujo-C4X_G4ez.js";const j={props:{plato:{type:Object,required:!0}},methods:{addDish(){this.$emit("add",this.plato)}}},L={id:"plato",class:"info-plato"},z={class:"container-info"},J={class:"txt-1vw"},R={class:"txt-1vw"},H={class:"txt-1vw"},q={class:"txt-1vw"};function W(k,c,i,u,p,o){return a(),r("div",L,[e("div",z,[e("div",null,[e("p",J,d(i.plato.nombre||"N/A"),1),e("p",R,d(i.plato.descripcion||"N/A"),1),e("p",H,d(i.plato.ingredientes||"N/A"),1),e("p",q,d(i.plato.precio?`${i.plato.precio}€`:"N/A"),1)]),c[1]||(c[1]=e("img",{src:V,alt:"Imagen plato"},null,-1))]),e("button",{class:"btn-anadir txt-1vw",onClick:c[0]||(c[0]=(...x)=>o.addDish&&o.addDish(...x))},"Añadir")])}const b=y(j,[["render",W],["__scopeId","data-v-215e61e8"]]),G={class:"titulo-menu txt-3vw"},K={class:"container-general"},Q={class:"container-menu"},U={class:"container-dish"},X={class:"lista-platos"},Y={class:"container-dish"},Z={class:"lista-platos"},ee={class:"container-dish"},te={class:"lista-platos"},se={class:"container-dish"},ae={class:"lista-platos"},oe={class:"container-comanda"},ne={class:"txt-1-5vw"},le=["onClick"],ie={class:"txt-1-5vw"},re={__name:"ClientMenuView",setup(k){const c=v([]),i=v(""),u=v([]),p=v(""),o=v(!1),{isAuthenticated:x,user:A,isLoading:de}=S(),C=A.value.name,N=()=>{const s=sessionStorage.getItem("platos"),t=sessionStorage.getItem("nombre_restaurante");s&&(c.value=JSON.parse(s)),t&&(i.value=t)};B(()=>{N()});const D=O(()=>u.value.reduce((s,t)=>s+parseFloat(t.precio||0),0)),h=s=>c.value.filter(t=>t.tipo_plato===s),f=s=>{u.value.push(s)},M=()=>{u.value.length===0?(p.value="Debe agregar al menos un producto a la comanda para realizar el pedido 😕",o.value=!0):P()},$=()=>{o.value=!1,window.location.reload()};async function P(){try{const s=await F("https://api-jummy.onrender.com/create-order",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:C,nombres_platos:u.value.map(t=>t.nombre),nombre_comercial:i.value})},1e4);s.status===201?(p.value="La comanda ha sido enviada correctamente, gracias por confiar en Jummy 😎",o.value=!0):s.status===500?(p.value="No se ha podido registrar la comanda enviada",o.value=!0):(p.value=`Error inesperado en el servidor
${s.statusText} 🛠️`,o.value=!0)}catch(s){p.value=s.message.includes("tiempo de espera")?"La solicitud ha excedido el tiempo de espera. Por favor, intentelo de nuevo mas tarde":"Error inesperado durante la solicitud",o.value=!0}}return(s,t)=>(a(),r("main",null,[w(I,{"show-return":!0}),e("div",null,[e("h1",G,d(i.value),1)]),e("div",K,[e("div",Q,[e("div",U,[t[0]||(t[0]=e("h2",{class:"txt-1-5vw"},"Entrantes",-1)),e("div",X,[(a(!0),r(m,null,_(h("Entrantes"),(n,l)=>(a(),g(b,{key:l,plato:n,onAdd:f},null,8,["plato"]))),128))])]),e("div",Y,[t[1]||(t[1]=e("h2",{class:"txt-1-5vw"},"Principales",-1)),e("div",Z,[(a(!0),r(m,null,_(h("Principales"),(n,l)=>(a(),g(b,{key:l,plato:n,onAdd:f},null,8,["plato"]))),128))])]),e("div",ee,[t[2]||(t[2]=e("h2",{class:"txt-1-5vw"},"Postres",-1)),e("div",te,[(a(!0),r(m,null,_(h("Postres"),(n,l)=>(a(),g(b,{key:l,plato:n,onAdd:f},null,8,["plato"]))),128))])]),e("div",se,[t[3]||(t[3]=e("h2",{class:"txt-1-5vw"},"Bebidas",-1)),e("div",ae,[(a(!0),r(m,null,_(h("Bebidas"),(n,l)=>(a(),g(b,{key:l,plato:n,onAdd:f},null,8,["plato"]))),128))])])]),e("div",oe,[t[4]||(t[4]=e("h2",{class:"txt-2vw"},"Comanda",-1)),(a(!0),r(m,null,_(u.value,(n,l)=>(a(),r("div",{key:l,class:"container-plato"},[e("p",ne,d(n.nombre)+" "+d(n.precio)+"€",1),e("span",{class:"txt-1-5vw",onClick:ce=>u.value.splice(l,1)},"🗑️",8,le)]))),128)),e("p",ie,"Total: "+d(D.value)+"€",1),e("button",{class:"btn-realizar-pedido txt-1vw",onClick:M},"Realizar pedido")])]),w(T),w(E,{message:p.value,visible:o.value,onClose:$},null,8,["message","visible"])]))}},he=y(re,[["__scopeId","data-v-315dfd42"]]);export{he as default};
